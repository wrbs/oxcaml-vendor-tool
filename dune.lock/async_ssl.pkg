(version v0.17.0-1)

(build
 (progn
  (patch no-incompatible-pointer-types-017.patch)
  (run dune build -p %{pkg-self:name} -j %{jobs})))

(depends
 ocaml
 async
 base
 core
 ppx_jane
 ppx_optcomp
 stdio
 conf-libssl
 ctypes
 ctypes-foreign
 dune
 dune-configurator)

(source
 (fetch
  (url
   https://github.com/janestreet/async_ssl/archive/refs/tags/v0.17.0.tar.gz)
  (checksum
   sha256=d1f9ca883ce9154571b2812235171707b70cb8e65b24ed3aeaec1fbebc5be1ba)))

(extra_sources
 (no-incompatible-pointer-types-017.patch
  (fetch
   (url
    https://raw.githubusercontent.com/ocaml/opam-source-archives/main/patches/async_ssl/no-incompatible-pointer-types-017.patch)
   (checksum
    sha256=6e97c88bdeff6f5848c2c173b26845019575c3c09d68cc57a22ef649c4983236))))
